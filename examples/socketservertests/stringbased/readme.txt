this implementation is much faster than the message based one
it goes for 10000-15000 roundtrips per second on my notebook (when used for a simple test)
